name: Deploy static content to Pages

on:
  push:
    branches: ["main"]  # main ë¸Œëœì¹˜ì— ì½”ë“œê°€ ì˜¬ë¼ì˜¤ë©´ ì‹¤í–‰

# ê¶Œí•œ ì„¤ì •
permissions:
  contents: read
  pages: write
  id-token: write

# ë°°í¬ ì‘ì—…
jobs:
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup node
        uses: actions/setup-node@v4
        with: 
          node-version: 18
          cache: 'npm'


      - name: Install dependencies
        run: npm ci

      - name: Convert blog posts
        run: npm run generate-posts

      # ğŸŒŸ [í•µì‹¬] ì½”ë“œ ë‚´ì˜ ì„ì‹œ ë¬¸êµ¬ë¥¼ ì§„ì§œ ì‹œí¬ë¦¿ í‚¤ë¡œ êµì²´í•˜ëŠ” ë‹¨ê³„
      - name: Inject Secret Key
        run: |
          # index.html íŒŒì¼ì—ì„œ 'REPLACE_MY_SECRET_KEY'ë¥¼ ì°¾ì•„ì„œ GitHub Secretìœ¼ë¡œ ë°”ê¿ˆ
          sed -i 's|REPLACE_MY_SECRET_KEY|${{ secrets.DIRECT_LINE_SECRET }}|g' index.html
        # âš ï¸ ë§Œì•½ HTML íŒŒì¼ëª…ì´ index.htmlì´ ì•„ë‹ˆë¼ë©´ ìœ„ ì´ë¦„ì„ ìˆ˜ì •í•˜ì„¸ìš”!

      # â­ build í´ë”ë§Œ ì—…ë¡œë“œ
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: './build'

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
